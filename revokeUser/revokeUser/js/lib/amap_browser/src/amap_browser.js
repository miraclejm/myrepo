!function(e){"use strict";"function"==typeof define&&define.amd?define(["util"],e):e(AmapApp.util)}(function(e){"use strict";function n(n,a,o,i){function t(e){e.remove(),window[c]=void 0}d+=1;var c=l+d;window[c]=function(e){o(e,i)};var p="http://wb.amap.com/channel.php?aoscommon=1&callback="+c+"&urlname="+encodeURIComponent(n)+"&param="+encodeURIComponent(JSON.stringify(a));e.addScript(p,t,function(e){window[c]({content:{code:-2}}),t(e)})}function a(e){return(m?"ios":"android")+"amap://openFeature?featureName=OpenURL&sa=1&sourceApplication=banner&url="+encodeURIComponent(e)+"&urlType=0&contentType=autonavi"}function o(n){u=n,m?t(n):(e.addScript("http://127.0.0.1:6677/getpackageinfo?callback=amapCallback1"),setTimeout(function(){s||t(n)},400))}function i(e){o(a(e))}function t(n){if(e.os.ios&&parseInt(e.os.version)>=9)return void(window.location.href=n);var a=document.getElementById("loadSchemaIframe");a||(a=document.createElement("iframe"),a.id="loadSchemaIframe",a.style.display="none",document.body.appendChild(a)),a.src=n}function c(e,n){location.href="http://wap.amap.com/callnative/?schema="+encodeURIComponent(a(e))+"&title="+encodeURIComponent(n||"")}function p(n,a){e.addScript("http://res.wx.qq.com/open/js/jweixin-1.0.0.js",function(){e.addScript("http://wb.amap.com/sign.php?r="+Math.random(),function(){r(n,a)})})}function r(n,a){wx.ready(function(){wx.checkJsApi({jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],success:function(o){function i(e){return function(){a&&a({result:"ok",type:e})}}var t={};t[e.IN_AMAP_KEY]="0";for(var c=n.length-1;c>=0;c--){var p=n[c];"weixin"===p.type&&o.checkResult.onMenuShareAppMessage?(t[e.PAGE_SOURCE_KEY]="weixin",wx.onMenuShareAppMessage({title:p.title,desc:p.message,link:e.urlAddParam(p.url,t),imgUrl:p.imgUrl,success:i("weixin")})):"pengyou"===p.type&&o.checkResult.onMenuShareTimeline&&(t[e.PAGE_SOURCE_KEY]="pengyou",wx.onMenuShareTimeline({title:p.title,link:e.urlAddParam(p.url,t),imgUrl:p.imgUrl,success:i("pengyou")}))}}})})}var u,m=e.os.ios,d=0,l="_aosJsonpRequest",s=!1;window.amapCallback1=function(n){if(n&&"0"==n.error_code&&n.version_code>=420&&"com.autonavi.minimap"===n["package"]){var a=u.replace(/^\w+map:\/\//i,"").replace("?","&");e.addScript("http://127.0.0.1:6677/androidamap?action="+a+"&callback=amapCallback2")}},window.amapCallback2=function(){s=!0};var f={aosJsonp:n,openAmap:o,openAmapBanner:i,openWeixinPrompt:c,weixinShare:p,weixinShareConfig:r};return"function"==typeof define&&define.amd?f:void(AmapApp.bapi=f)});